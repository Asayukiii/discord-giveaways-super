"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JSONParser=void 0;const promises_1=require("fs/promises"),typeOf_function_1=require("../functions/typeOf.function");class JSONParser{jsonFilePath;minifyJSON;constructor(t,e=!1){this.jsonFilePath=t,this.minifyJSON=e}async fetchDatabaseFile(){const t=await(0,promises_1.readFile)(this.jsonFilePath,"utf-8");return JSON.parse(t)}async get(t){let e=await this.fetchDatabaseFile(),i=e;const s=t.split(".");for(let t=0;t<s.length;t++)s.length-1==t&&(e=i?.[s[t]]||null),i=i?.[s[t]];return e}async set(t,e){const i=await this.fetchDatabaseFile();let s=i;const n=t.split(".");for(let t=0;t<n.length;t++)n.length-1==t?s[n[t]]=e:(0,typeOf_function_1.isObject)(i[n[t]])||(s[n[t]]={}),s=s?.[n[t]];return await(0,promises_1.writeFile)(this.jsonFilePath,JSON.stringify(i,null,this.minifyJSON?void 0:"\t")),i}async delete(t){const e=await this.fetchDatabaseFile();let i=e;const s=t.split(".");for(let t=0;t<s.length;t++)s.length-1==t?delete i[s[t]]:(0,typeOf_function_1.isObject)(e[s[t]])||(i[s[t]]={}),i=i?.[s[t]];return await(0,promises_1.writeFile)(this.jsonFilePath,JSON.stringify(e,null,this.minifyJSON?void 0:"\t")),!0}async clearDatabase(){return await(0,promises_1.writeFile)(this.jsonFilePath,"{}"),!0}}exports.JSONParser=JSONParser;
